
CondaError: Run 'conda init' before 'conda activate'

2025-03-20 02:20:28,848	INFO worker.py:1812 -- Started a local Ray instance. View the dashboard at [1m[32mhttp://127.0.0.1:8268 [39m[22m
Loading safetensors checkpoint shards:   0% Completed | 0/15 [00:00<?, ?it/s]
Loading safetensors checkpoint shards:   7% Completed | 1/15 [00:08<01:53,  8.12s/it]
Loading safetensors checkpoint shards:  13% Completed | 2/15 [00:14<01:35,  7.36s/it]
Loading safetensors checkpoint shards:  20% Completed | 3/15 [00:17<01:02,  5.20s/it]
Loading safetensors checkpoint shards:  27% Completed | 4/15 [00:19<00:41,  3.78s/it]
Loading safetensors checkpoint shards:  33% Completed | 5/15 [00:20<00:29,  2.96s/it]
Loading safetensors checkpoint shards:  40% Completed | 6/15 [00:22<00:21,  2.41s/it]
Loading safetensors checkpoint shards:  47% Completed | 7/15 [00:23<00:17,  2.17s/it]
Loading safetensors checkpoint shards:  53% Completed | 8/15 [00:25<00:13,  1.94s/it]
Loading safetensors checkpoint shards:  60% Completed | 9/15 [00:26<00:10,  1.82s/it]
Loading safetensors checkpoint shards:  67% Completed | 10/15 [00:28<00:08,  1.77s/it]
Loading safetensors checkpoint shards:  73% Completed | 11/15 [00:37<00:16,  4.10s/it]
Loading safetensors checkpoint shards:  80% Completed | 12/15 [00:50<00:20,  6.72s/it]
Loading safetensors checkpoint shards:  87% Completed | 13/15 [01:02<00:16,  8.46s/it]
Loading safetensors checkpoint shards:  93% Completed | 14/15 [01:15<00:09,  9.59s/it]
Loading safetensors checkpoint shards: 100% Completed | 15/15 [01:24<00:00,  9.38s/it]
Loading safetensors checkpoint shards: 100% Completed | 15/15 [01:24<00:00,  5.60s/it]

Capturing CUDA graph shapes:   0%|          | 0/35 [00:00<?, ?it/s]Capturing CUDA graph shapes:   3%|▎         | 1/35 [00:00<00:27,  1.24it/s]Capturing CUDA graph shapes:   6%|▌         | 2/35 [00:01<00:26,  1.24it/s]Capturing CUDA graph shapes:   9%|▊         | 3/35 [00:02<00:26,  1.23it/s]Capturing CUDA graph shapes:  11%|█▏        | 4/35 [00:03<00:25,  1.23it/s]Capturing CUDA graph shapes:  14%|█▍        | 5/35 [00:04<00:25,  1.19it/s]Capturing CUDA graph shapes:  17%|█▋        | 6/35 [00:05<00:25,  1.12it/s]Capturing CUDA graph shapes:  20%|██        | 7/35 [00:05<00:23,  1.17it/s]Capturing CUDA graph shapes:  23%|██▎       | 8/35 [00:06<00:22,  1.18it/s]Capturing CUDA graph shapes:  26%|██▌       | 9/35 [00:07<00:21,  1.22it/s]Capturing CUDA graph shapes:  29%|██▊       | 10/35 [00:08<00:19,  1.26it/s]Capturing CUDA graph shapes:  31%|███▏      | 11/35 [00:08<00:18,  1.28it/s]Capturing CUDA graph shapes:  34%|███▍      | 12/35 [00:09<00:17,  1.29it/s]Capturing CUDA graph shapes:  37%|███▋      | 13/35 [00:10<00:17,  1.27it/s]Capturing CUDA graph shapes:  40%|████      | 14/35 [00:11<00:16,  1.27it/s]Capturing CUDA graph shapes:  43%|████▎     | 15/35 [00:12<00:15,  1.26it/s]Capturing CUDA graph shapes:  46%|████▌     | 16/35 [00:12<00:15,  1.24it/s]Capturing CUDA graph shapes:  49%|████▊     | 17/35 [00:13<00:14,  1.24it/s]Capturing CUDA graph shapes:  51%|█████▏    | 18/35 [00:14<00:13,  1.26it/s]Capturing CUDA graph shapes:  54%|█████▍    | 19/35 [00:15<00:12,  1.31it/s]Capturing CUDA graph shapes:  57%|█████▋    | 20/35 [00:15<00:11,  1.35it/s]Capturing CUDA graph shapes:  60%|██████    | 21/35 [00:16<00:10,  1.32it/s]Capturing CUDA graph shapes:  63%|██████▎   | 22/35 [00:17<00:09,  1.33it/s]Capturing CUDA graph shapes:  66%|██████▌   | 23/35 [00:18<00:08,  1.34it/s]Capturing CUDA graph shapes:  69%|██████▊   | 24/35 [00:18<00:08,  1.34it/s]Capturing CUDA graph shapes:  71%|███████▏  | 25/35 [00:19<00:07,  1.34it/s]Capturing CUDA graph shapes:  74%|███████▍  | 26/35 [00:20<00:06,  1.31it/s]Capturing CUDA graph shapes:  77%|███████▋  | 27/35 [00:21<00:07,  1.13it/s]Capturing CUDA graph shapes:  80%|████████  | 28/35 [00:22<00:06,  1.09it/s]Capturing CUDA graph shapes:  83%|████████▎ | 29/35 [00:23<00:04,  1.23it/s]Capturing CUDA graph shapes:  86%|████████▌ | 30/35 [00:23<00:03,  1.28it/s]Capturing CUDA graph shapes:  89%|████████▊ | 31/35 [00:24<00:03,  1.27it/s]Capturing CUDA graph shapes:  91%|█████████▏| 32/35 [00:25<00:02,  1.28it/s]Capturing CUDA graph shapes:  94%|█████████▍| 33/35 [00:26<00:01,  1.28it/s]Capturing CUDA graph shapes:  97%|█████████▋| 34/35 [00:27<00:00,  1.28it/s]Capturing CUDA graph shapes: 100%|██████████| 35/35 [00:28<00:00,  1.00s/it]Capturing CUDA graph shapes: 100%|██████████| 35/35 [00:28<00:00,  1.22it/s]
2025-03-20 02:23:22,520 - INFO - Loaded model from /scratch3/workspace/amekala_umass_edu-quantized_models2/hub/Meta-Llama-3.1-70B-Instruct-GPTQ-W8A16. - CPU Memory usage: 7355.84 MB RSS
2025-03-20 02:23:22,559 - INFO - GPU 0: 72823/81920 MB
2025-03-20 02:23:22,559 - INFO - GPU 1: 72821/81920 MB
[rank0]: Traceback (most recent call last):
[rank0]:   File "/work/pi_miyyer_umass_edu/anmol/oneruler/OneRuler/ruler.py", line 121, in <module>
[rank0]:     process_data_dump(args.model_short_name, input_file_path, args.ctx, out_file_path, llm, tokenizer)
[rank0]:   File "/work/pi_miyyer_umass_edu/anmol/oneruler/OneRuler/ruler.py", line 23, in process_data_dump
[rank0]:     with open(input_file, 'r', encoding='utf-8') as f:
[rank0]:          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]: FileNotFoundError: [Errno 2] No such file or directory: '/work/pi_miyyer_umass_edu/yekyung/git/Multilang-RULER/scripts/benchmark_root/Llama3.1/pl/32000/data/niah_single/validation.jsonl'
Fatal Python error: _enter_buffered_busy: could not acquire lock for <_io.BufferedWriter name='<stdout>'> at interpreter shutdown, possibly due to daemon threads
Python runtime state: finalizing (tstate=0x00005fa57ed109f8)

Current thread 0x000076cb4e12c740 (most recent call first):
  <no Python frame>

Extension modules: numpy.core._multiarray_umath, numpy.core._multiarray_tests, numpy.linalg._umath_linalg, numpy.fft._pocketfft_internal, numpy.random._common, numpy.random.bit_generator, numpy.random._bounded_integers, numpy.random._mt19937, numpy.random.mtrand, numpy.random._philox, numpy.random._pcg64, numpy.random._sfc64, numpy.random._generator, torch._C, torch._C._dynamo.autograd_compiler, torch._C._dynamo.eval_frame, torch._C._dynamo.guards, torch._C._dynamo.utils, torch._C._fft, torch._C._linalg, torch._C._nested, torch._C._nn, torch._C._sparse, torch._C._special, zstandard.backend_c, charset_normalizer.md, requests.packages.charset_normalizer.md, requests.packages.chardet.md, yaml._yaml, markupsafe._speedups, PIL._imaging, sentencepiece._sentencepiece, sklearn.__check_build._check_build, psutil._psutil_linux, psutil._psutil_posix, scipy._lib._ccallback_c, scipy.sparse._sparsetools, _csparsetools, scipy.sparse._csparsetools, scipy.linalg._fblas, scipy.linalg._flapack, scipy.linalg.cython_lapack, scipy.linalg._cythonized_array_utils, scipy.linalg._solve_toeplitz, scipy.linalg._decomp_lu_cython, scipy.linalg._matfuncs_sqrtm_triu, scipy.linalg.cython_blas, scipy.linalg._matfuncs_expm, scipy.linalg._decomp_update, scipy.sparse.linalg._dsolve._superlu, scipy.sparse.linalg._eigen.arpack._arpack, scipy.sparse.linalg._propack._spropack, scipy.sparse.linalg._propack._dpropack, scipy.sparse.linalg._propack._cpropack, scipy.sparse.linalg._propack._zpropack, scipy.sparse.csgraph._tools, scipy.sparse.csgraph._shortest_path, scipy.sparse.csgraph._traversal, scipy.sparse.csgraph._min_spanning_tree, scipy.sparse.csgraph._flow, scipy.sparse.csgraph._matching, scipy.sparse.csgraph._reordering, scipy.special._ufuncs_cxx, scipy.special._ufuncs, scipy.special._specfun, scipy.special._comb, scipy.special._ellip_harm_2, scipy.spatial._ckdtree, scipy._lib.messagestream, scipy.spatial._qhull, scipy.spatial._voronoi, scipy.spatial._distance_wrap, scipy.spatial._hausdorff, scipy.spatial.transform._rotation, scipy.optimize._group_columns, scipy.optimize._trlib._trlib, scipy.optimize._lbfgsb, _moduleTNC, scipy.optimize._moduleTNC, scipy.optimize._cobyla, scipy.optimize._slsqp, scipy.optimize._minpack, scipy.optimize._lsq.givens_elimination, scipy.optimize._zeros, scipy.optimize._highs.cython.src._highs_wrapper, scipy.optimize._highs._highs_wrapper, scipy.optimize._highs.cython.src._highs_constants, scipy.optimize._highs._highs_constants, scipy.linalg._interpolative, scipy.optimize._bglu_dense, scipy.optimize._lsap, scipy.optimize._direct, scipy.integrate._odepack, scipy.integrate._quadpack, scipy.integrate._vode, scipy.integrate._dop, scipy.integrate._lsoda, scipy.interpolate._fitpack, scipy.interpolate._dfitpack, scipy.interpolate._bspl, scipy.interpolate._ppoly, scipy.interpolate.interpnd, scipy.interpolate._rbfinterp_pythran, scipy.interpolate._rgi_cython, scipy.special.cython_special, scipy.stats._stats, scipy.stats._biasedurn, scipy.stats._levy_stable.levyst, scipy.stats._stats_pythran, scipy._lib._uarray._uarray, scipy.stats._ansari_swilk_statistics, scipy.stats._sobol, scipy.stats._qmc_cy, scipy.stats._mvn, scipy.stats._rcont.rcont, scipy.stats._unuran.unuran_wrapper, scipy.ndimage._nd_image, _ni_label, scipy.ndimage._ni_label, pyarrow.lib, pandas._libs.tslibs.ccalendar, pandas._libs.tslibs.np_datetime, pandas._libs.tslibs.dtypes, pandas._libs.tslibs.base, pandas._libs.tslibs.nattype, pandas._libs.tslibs.timezones, pandas._libs.tslibs.fields, pandas._libs.tslibs.timedeltas, pandas._libs.tslibs.tzconversion, pandas._libs.tslibs.timestamps, pandas._libs.properties, pandas._libs.tslibs.offsets, pandas._libs.tslibs.strptime, pandas._libs.tslibs.parsing, pandas._libs.tslibs.conversion, pandas._libs.tslibs.period, pandas._libs.tslibs.vectorized, pandas._libs.ops_dispatch, pandas._libs.missing, pandas._libs.hashtable, pandas._libs.algos, pandas._libs.interval, pandas._libs.lib, pyarrow._compute, pandas._libs.ops, pandas._libs.hashing, pandas._libs.arrays, pandas._libs.tslib, pandas._libs.sparse, pandas._libs.internals, pandas._libs.indexing, pandas._libs.index, pandas._libs.writers, pandas._libs.join, pandas._libs.window.aggregations, pandas._libs.window.indexers, pandas._libs.reshape, pandas._libs.groupby, pandas._libs.json, pandas._libs.parsers, pandas._libs.testing, sklearn.utils._isfinite, sklearn.utils.sparsefuncs_fast, sklearn.utils.murmurhash, sklearn.utils._openmp_helpers, sklearn.metrics.cluster._expected_mutual_info_fast, sklearn.preprocessing._csr_polynomial_expansion, sklearn.preprocessing._target_encoder_fast, sklearn.metrics._dist_metrics, sklearn.metrics._pairwise_distances_reduction._datasets_pair, sklearn.utils._cython_blas, sklearn.metrics._pairwise_distances_reduction._base, sklearn.metrics._pairwise_distances_reduction._middle_term_computer, sklearn.utils._heap, sklearn.utils._sorting, sklearn.metrics._pairwise_distances_reduction._argkmin, sklearn.metrics._pairwise_distances_reduction._argkmin_classmode, sklearn.utils._vector_sentinel, sklearn.metrics._pairwise_distances_reduction._radius_neighbors, sklearn.metrics._pairwise_distances_reduction._radius_neighbors_classmode, sklearn.metrics._pairwise_fast, msgspec._core, PIL._imagingft, regex._regex, zmq.backend.cython._zmq, multidict._multidict, yarl._quoting_c, propcache._helpers_c, aiohttp._http_writer, aiohttp._http_parser, aiohttp._websocket.mask, aiohttp._websocket.reader_c, frozenlist._frozenlist, msgpack._cmsgpack, google._upb._message, setproctitle, uvloop.loop, ray._raylet, grpc._cython.cygrpc, vllm.cumem_allocator, cuda_utils, __triton_launcher (total: 202)
/work/pi_miyyer_umass_edu/anmol/conda_storage/.conda/envs/helmet/lib/python3.11/multiprocessing/resource_tracker.py:254: UserWarning: resource_tracker: There appear to be 1 leaked semaphore objects to clean up at shutdown
  warnings.warn('resource_tracker: There appear to be %d '
/work/pi_miyyer_umass_edu/anmol/conda_storage/.conda/envs/helmet/lib/python3.11/multiprocessing/resource_tracker.py:254: UserWarning: resource_tracker: There appear to be 1 leaked shared_memory objects to clean up at shutdown
  warnings.warn('resource_tracker: There appear to be %d '
/var/spool/slurm/slurmd/job29980771/slurm_script: line 19: 3985548 Aborted                 python OneRuler/ruler.py -m llama3.1_70b_gptq-int8 --data_root /work/pi_miyyer_umass_edu/yekyung/git/Multilang-RULER/scripts/benchmark_root/Llama3.1 --lang pl --ctx 32000 --task_name niah_single --out_dir results
